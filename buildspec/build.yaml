version: 0.2

env:
  secrets-manager:
    TF_VAR_github_token: arn:aws:secretsmanager:us-east-1:482352589093:secret:scp-github-access-token-wl0bYW:TF_VAR_github_token

phases:
  build:
    commands:
      - echo $CODEBUILD_RESOLVED_SOURCE_VERSION
      - cd ./src/CryptoSoundUI
      - docker login -u storycollector | $DOCKER_KEY
      - docker build . -t scp-cs-$ENV:$CODEBUILD_RESOLVED_SOURCE_VERSION
      - docker image push $ECR_URL/scp-cs-$ENV:$CODEBUILD_RESOLVED_SOURCE_VERSION